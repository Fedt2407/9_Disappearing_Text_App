<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='styles.css') }}"
    />
    <title>Disappearing Text App</title>
  </head>
  <body>
    <h2 id="timer" style="visibility: hidden">Time remaining: 5 seconds</h2>
    <textarea id="textArea" placeholder="Type something..."></textarea>
    <script>
      let timer;
      let countdown;
      const textArea = document.getElementById("textArea");
      const timerElement = document.getElementById("timer");

      textArea.addEventListener("input", () => {
        clearTimeout(timer);
        clearInterval(countdown);
        timerElement.style.visibility = "hidden"; // Hide the timer initially
        let timeLeft = 5; // Set the countdown time

        timer = setTimeout(() => {
          const textContent = textArea.value;
          console.log("User stopped typing");

          fetch("/user_stopped_typing", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({ text: textContent }),
          })
            .then((response) => response.json())
            .then((data) => console.log(data))
            .catch((error) => console.error("Error:", error));
        }, 10000);

        countdown = setInterval(() => {
          timeLeft--;
          if (timeLeft > 0) {
            timerElement.style.visibility = "visible";
            timerElement.textContent = `Time remaining: ${timeLeft}`;
          } else {
            clearInterval(countdown);
            timerElement.textContent = "Time's up!";
          }
        }, 1000);
      });
    </script>
  </body>
</html>
